<html lang=en><meta charset=utf-8><title>TIL: DOCKER CAN OVERRIDE UFW RULES | Richard Taylor</title><meta name=description content="Today I learned: Docker can override UFW rules and how to prevent it"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/css/enough.css as=style><link rel=alternate type=application/atom+xml href=/index.xml><link rel=stylesheet href=/css/enough.css><link rel=icon type=image/png href=/img/icon.png><link rel=apple-touch-icon href=/img/icon.png><link rel=apple-touch-icon sizes=80x80 href=/img/icon-80.png><link rel=apple-touch-icon sizes=120x120 href=/img/icon-120.png><link rel=apple-touch-icon sizes=180x180 href=/img/icon-180.png><style>body{font:18px/1.4 system-ui,sans-serif;margin:auto;max-width:40em}body,pre{padding:1em}h1,h2,h3,h4,h5,h6{line-height:normal}a{text-decoration:none}a:hover{text-decoration:underline}img,video,pre{margin:2em auto 2em}img,video{max-width:100%;display:block}pre,code{font:.8em Monaco,monospace;overflow-x:auto}blockquote{font-style:italic}footer,nav{font-size:.8em;width:100%}footer{margin:2em 0 1em;text-align:center}nav{text-transform:uppercase;padding-bottom:5px}nav ul{list-style-type:none;margin:0;padding:0}nav li{display:inline;margin-right:1em}nav a.active{text-decoration:underline}</style><style>body{background-color:#132338;color:#bbc9d9}h1,h2,h3,h4,h5,h6{color:#fff}a{color:#ffc24f}pre{background-color:#162840}code{color:#adcc2b}blockquote{color:#696969}footer,nav{color:#b8bdc3}nav a,footer a{color:#9cb3c9}</style><link rel=canonical href=https://richt.co.uk/til/docker-can-override-ufw-rules/><meta property=og:title content="TIL: Docker can override UFW rules"><meta property=og:description content="Today I learned: Docker can override UFW rules and how to prevent it"><meta property=og:url content=https://richt.co.uk/til/docker-can-override-ufw-rules/><meta property=og:site_name content=richt.co.uk><meta property=og:type content=article><meta name=twitter:card content=summary><meta name=twitter:image content=https://richt.co.uk/assets/images/avatar.jpg><meta property=og:image content=https://richt.co.uk/assets/images/avatar.jpg><meta name=twitter:site content=@moomerman><meta name=twitter:title content="TIL: Docker can override UFW rules"><meta name=twitter:description content="Today I learned: Docker can override UFW rules and how to prevent it"><nav><ul><li><a href=/>HOME</a><li><a href=https://richt.co.uk/articles/>Articles</a><li><a href=https://richt.co.uk/projects/>Projects</a><li><a href=https://richt.co.uk/til/ class=active>Til</a></ul></nav><article><h1>TIL: Docker can override UFW rules</h1><small style=display:block;position:relative;top:-15px><a href=https://rd.gl/me rel=author>Richard Taylor</a>
• <time>September 2017</time>
• 1m read</small><p>If you&rsquo;re using Ubuntu&rsquo;s Uncomplicated Firewall (UFW) on your host and running
services with Docker mapped ports, these services can bypass your UFW configuration.<p><p>For example, on a host <code>46.101.60.103</code> with the following UFW configuration:<div class=highlight style=background:#272822><pre style=line-height:125%><span></span>Status: active

To                         Action      From
--                         ------      ----
22/tcp                     ALLOW       Anywhere
22/tcp (v6)                ALLOW       Anywhere (v6)
</pre></div><p>You would think that external users can only access the SSH port. However,
running a container as an unprivileged user like this:<div class=highlight style=background:#272822><pre style=line-height:125%><span></span>docker run -d -p 8080:80 nginx
</pre></div><p>Results in port 8080 being accessible to the public on your host:<p><img src=nginx.png alt=Nginx><p>If you don&rsquo;t intend to expose the service directly, then you can bind it to
localhost in the port mapping like this:<div class=highlight style=background:#272822><pre style=line-height:125%><span></span>docker run -d -p 127.0.0.1:8080:80 nginx
</pre></div></article><footer>&copy; 2017 <a href=https://rd.gl/me>RICHARD TAYLOR</a>
◇ <a href=/>HOME</a></footer>